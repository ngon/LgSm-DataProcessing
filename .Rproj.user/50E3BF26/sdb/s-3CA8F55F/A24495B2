{
    "contents" : "######## Auxillary code to generate plots ###############\n\n## Working directory on Natalia's computer PalmerLab-Atlas\nsetwd(\"C:/Users/Administrator/Desktop/Scripts/LgSm-DataProcessing/figures/manhattan\")\n\n\n## First, read in chrLengths from the mm10 reference. \n## In CRI: 'group/palmer-lab/reference_genomes/mouse/chrLengths_mm10_chrnames.txt'\nchrLens    <- read.table(\"chrLengths_mm10.txt\")$V2\nchrLens    <- c(0, cumsum(chrLens*1.0))\n\nlabPos     <- read.table(\"chrLengths_mm10.txt\")$V2/2.0\nlabPos     <- chrLens[1:19]+labPos\n\n\ntraits <- c(#\"cpp.diff\", \n            #\"cpp8.1\", \n            \"cpp8.t\",\n            \"act2.t\", \n            #\"act4.t\", \n            \"act5.t\",\n            #\"act8.t\", \n            #\"sens\", \n            #\"startle\", \n            #\"wild\", \n            #\"ppi3\", \n            #\"ppi6\", \n            \"ppi12\", \n            #\"habituation\", \n            #\"glucose\")\n\ntitles <- c(#\"Change in preference for meth paired side\", \n            #\"Time spent on meth paired side on day 8 (5 min)\", \n            \"Time spent on meth paired side on day 8 (30 min)\", \n            \"Day 2 activity (1 mg/kg meth)\", \n            #\"Day 4 activity (1 mg/kg meth)\", \n            \"Day 5 activity (saline)\",\n            #\"Day 8 activity (saline)\",\n            #\"Locomotor sensitization to meth\", \n            #\"Acoustic startle response\", \n            #\"Wildness (number of escapes during CPP)\", \n            #\"Prepulse inhibition (73 dB)\",\n            #\"Prepulse inhibition (76 dB)\", \n            \"Prepulse inhibition (82 dB)\", \n            #\"Habituation to acoustic startle\",\n            #\"Blood glucose levels after a 4h fast\")\n\noutfiles <- paste0(traits, \".manhattan.png\")\n\n\nfor (index in 1:3) {\n        print(paste(\"Starting trait\", traits[index]))\n        plotManhattan(traits[index], outfile=outfiles[index], title=titles[index])\n        print(paste(\"Done with trait\", traits[index]))\n}\n\n\n\n\nplotManhattan <- function(trait, outfile=NULL, \n                          oddcolor=\"#ff6040\", evencolor=\"#aab0be\", \n                          signifLine=6, signifColor=\"#000000\", title=NULL) {\n        if (is.null(outfile)) {\n                outfile <- paste0(trait, \".manhattan.png\")\n        }\n        if (is.null(title)) {\n                title = trait\n        }\n        png(file=outfile, height=600, width=1400, bg=\"transparent\")\n        pvals <- c()\n        positions <- c()\n        cols <- c()\n        \n        for (chrom in 1:19) {\n                filename <- paste0(trait, \".chr\", chrom, \".assoc.txt\")\n                print(paste(\"Starting chromosome\", chrom))\n                output <- read.table(filename, header=T, as.is=TRUE)\n                output$chr <- as.numeric(sub(\"chr\", \"\", output$chr))\n                pvals <- c(pvals, -log10(output$p_lrt))\n                positions <- c(positions, chrLens[output$chr]+output$ps)\n                if (chrom %% 2) {\n                        cols <- c(cols, rep(oddcolor, nrow(output)))\n                } else {\n                        cols <- c(cols, rep(evencolor, nrow(output)))\n                }\n                print(paste(\"Done with chromosome\", chrom))\n        }\n        plot(positions, pvals, col=cols, pch=19, cex=0.78, main=title, ylab='-log10(p-value)', xlab='Position', axes=F, frame.plot=T, cex.lab=1.7, cex.main=1.8, font.main=1)\n        axis(2, cex.axis=1.5)\n        axis(1, at=labPos, labels=1:19, tick=F, cex.axis=1.5)\n        abline(h=signifLine, col=signifColor, lty=2)\n        dev.off()\n}\n\n\n\n\n# plotZoom <- function(trait, chrom, start, end, outfile=NULL, dotColor=\"firebrick\", signifLine=6, signifColor=\"darkorange1\", title=NULL, scaling=1e6, scalename=\"(Mb)\") {\n#     if (is.null(outfile)) {\n#         outfile <- paste0(trait, \".chr\", chrom, \".\", as.character(start), \".\", as.character(end), \".zoom.jpg\")\n#     }\n#     if (is.null(title)) {\n#         title = trait\n#     }\n#     jpeg(file=outfile, quality=95)\n#     filename <- paste0(\"/home/shyamg/projects/Mouse/AIL/LgSm-DataProcessing/output/\", trait, \".chr\", chrom, \".assoc.txt\")\n#     print(paste(\"Starting chromosome\", chrom))\n#     output <- read.table(filename, header=T)\n#     pvals <- -log10(output$p_lrt)\n#     positions <- output$ps/scaling\n#     print(paste(\"Done with chromosome\", chrom))\n#     ### Code to plot\n#     start = start/scaling\n#     end = end/scaling\n#     plot(positions, pvals, col=dotColor, pch=19, cex=0.75, main=title, ylab='-log10(p-value)', xlab=paste('Position', scalename), axes=F, frame.plot=T, cex.lab=1.1, xlim=c(start, end))\n#     axis(2, cex.axis=1.2)\n#     axis(1, cex.axis=1.2)\n#     abline(h=signifLine, col=signifColor, lty=2)\n#     dev.off()        \n# }\n\n\n\n\n\n\n",
    "created" : 1424303776826.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1986508136",
    "id" : "A24495B2",
    "lastKnownWriteTime" : 1424307235,
    "path" : "C:/Users/Administrator/Desktop/Scripts/LgSm-DataProcessing/figures/manhattan/plotQTL.R",
    "project_path" : "figures/manhattan/plotQTL.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "source_on_save" : false,
    "type" : "r_source"
}