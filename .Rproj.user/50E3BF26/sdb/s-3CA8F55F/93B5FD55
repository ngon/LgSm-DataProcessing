{
    "contents" : "######## Auxillary code to generate plots ###############\n#Code to plot manhattanplot\nchrLens    <- read.table('/group/palmer-lab/reference_genomes/mouse/chrLengths_mm10_chrnames.txt')$V2\nchrLens    <- c(0, cumsum(chrLens*1.0))\nchrLens    <- chrLens[1:20]\nlabPos     <- read.table('/group/palmer-lab/reference_genomes/mouse/chrLengths_mm10_chrnames.txt')$V2/2.0\nlabPos     <- labPos[1:19]\nlabPos     <- chrLens[1:19]+labPos\n\nplotManhattan <- function(trait, outfile=NULL, \n                          oddcolor=\"#ff6040\", evencolor=\"#aab0be\", \n                          signifLine=6, signifColor=\"#000000\", title=NULL) {\n    if (is.null(outfile)) {\n        outfile <- paste0(trait, \".manhattan.pdf\")\n    }\n    if (is.null(title)) {\n        title = trait\n    }\n    pdf(file=outfile, height=4.5, width=10, bg=\"transparent\")\n    pvals <- c()\n    positions <- c()\n    cols <- c()\n    \n    for (chrom in 1:19) {\n        filename <- paste0(\"/group/palmer-lab/AIL/qtlmapping/output/\", trait, \".chr\", chrom, \".assoc.txt\")\n        print(paste(\"Starting chromosome\", chrom))\n        output <- read.table(filename, header=T, as.is=TRUE)\n        output$chr <- as.numeric(sub(\"chr\", \"\", output$chr))\n        pvals <- c(pvals, -log10(output$p_lrt))\n        positions <- c(positions, chrLens[output$chr]+output$ps)\n        if (chrom %% 2) {\n            cols <- c(cols, rep(oddcolor, nrow(output)))\n        } else {\n            cols <- c(cols, rep(evencolor, nrow(output)))\n        }\n        print(paste(\"Done with chromosome\", chrom))\n    }\n    plot(positions, pvals, col=cols, pch=19, cex=0.78, main=title, ylab='-log10(p-value)', xlab='Position', axes=F, frame.plot=T, cex.lab=1.7, cex.main=1.8, font.main=1)\n    axis(2, cex.axis=1.5)\n    axis(1, at=labPos, labels=1:19, tick=F, cex.axis=1.5)\n    abline(h=signifLine, col=signifColor, lty=2)\n    dev.off()\n}\n\n\n\n\n# plotZoom <- function(trait, chrom, start, end, outfile=NULL, dotColor=\"firebrick\", signifLine=6, signifColor=\"darkorange1\", title=NULL, scaling=1e6, scalename=\"(Mb)\") {\n#     if (is.null(outfile)) {\n#         outfile <- paste0(trait, \".chr\", chrom, \".\", as.character(start), \".\", as.character(end), \".zoom.jpg\")\n#     }\n#     if (is.null(title)) {\n#         title = trait\n#     }\n#     jpeg(file=outfile, quality=95)\n#     filename <- paste0(\"/home/shyamg/projects/Mouse/AIL/LgSm-DataProcessing/output/\", trait, \".chr\", chrom, \".assoc.txt\")\n#     print(paste(\"Starting chromosome\", chrom))\n#     output <- read.table(filename, header=T)\n#     pvals <- -log10(output$p_lrt)\n#     positions <- output$ps/scaling\n#     print(paste(\"Done with chromosome\", chrom))\n#     ### Code to plot\n#     start = start/scaling\n#     end = end/scaling\n#     plot(positions, pvals, col=dotColor, pch=19, cex=0.75, main=title, ylab='-log10(p-value)', xlab=paste('Position', scalename), axes=F, frame.plot=T, cex.lab=1.1, xlim=c(start, end))\n#     axis(2, cex.axis=1.2)\n#     axis(1, cex.axis=1.2)\n#     abline(h=signifLine, col=signifColor, lty=2)\n#     dev.off()        \n# }\n\n\ntraits <- c(\"cpp.diff\", \"cpp8.1\", \"cpp8.t\", \"act2.t\", \"act4.t\", \"act8.t\", \"sens\", \"startle\", \"wild\", \"ppi3\", \"ppi6\", \"ppi12\", \"habituation\")\ntitles <- c(\"Change in preference for meth paired side\", \"Time spent on meth paired side on day 8 (5 min)\", \"Time spent on meth paired side on day 8 (30 min)\", \"Day 2 activity (1 mg/kg meth)\", \"Day 4 activity (1 mg/kg meth)\", \"Day 8 activity (saline)\",\"Locomotor sensitization to meth\", \"Acoustic startle response\", \"Wildness (number of escapes during cpp)\", \"Prepulse inhibition (73 dB)\", \"Prepulse inhibition (76 dB)\", \"Prepulse inhibition (82 dB)\", \"Habituation to acoustic startle\" )\noutfiles <- paste0(\"/group/palmer-lab/AIL/manhattanplots/\", traits, \".manhattan.pdf\")\n\n\ntraits <- c(\"sens\", \"startle\", \"wild\", \"ppi3\", \"ppi6\", \"ppi12\", \"habituation\")\ntitles <- c(\"Locomotor sensitization to meth\", \"Acoustic startle response\", \"Wildness (number of escapes during cpp)\", \"Prepulse inhibition (73 dB)\", \"Prepulse inhibition (76 dB)\", \"Prepulse inhibition (82 dB)\", \"Habituation to acoustic startle\" )\noutfiles <- paste0(\"/group/palmer-lab/AIL/manhattanplots/\", traits, \".manhattan.pdf\")\n\n\n\n\nfor (index in 1:1) {\n    print(paste(\"Starting trait\", traits[index]))\n    plotManhattan(traits[index], outfile=outfiles[index], title=titles[index])\n    print(paste(\"Done with trait\", traits[index]))\n}\n",
    "created" : 1424292437844.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1085967511",
    "id" : "93B5FD55",
    "lastKnownWriteTime" : 1424298925,
    "path" : "C:/Users/Administrator/Desktop/Scripts/LgSm-DataProcessing/scripts/plotManhattanGemma.R",
    "project_path" : "scripts/plotManhattanGemma.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}